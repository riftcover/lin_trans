# 任务完成检查清单

## 代码修改后的必做事项

### 1. 代码质量检查
- [ ] **代码审查**: 检查代码是否符合项目风格
- [ ] **类型提示**: 确保添加了适当的类型提示
- [ ] **文档字符串**: 为新函数/类添加文档字符串
- [ ] **日志记录**: 添加适当的日志记录（使用loguru）
- [ ] **异常处理**: 确保有适当的异常处理和用户提示

### 2. 测试
- [ ] **功能测试**: 手动测试新功能是否正常工作
- [ ] **边界测试**: 测试边界情况和异常输入
- [ ] **UI测试**: 如果涉及UI，测试不同窗口大小和主题
- [ ] **跨平台测试**: 如果可能，在macOS和Windows上测试

### 3. 依赖管理
- [ ] **新依赖**: 如果添加了新依赖，更新 `pyproject.toml`
- [ ] **使用包管理器**: 使用 `uv add <package>` 而不是手动编辑
- [ ] **锁文件**: 确保 `uv.lock` 已更新
- [ ] **版本兼容**: 检查新依赖与Python 3.11-3.12兼容

### 4. 资源文件
- [ ] **Qt资源**: 如果添加了新资源，更新 `lin_resource.qrc`
- [ ] **重新编译**: 运行 `pyside6-rcc components/lin_resource.qrc -o components/lin_resource_rc.py`
- [ ] **资源映射**: 在 `resource_manager.py` 中添加映射

### 5. 数据库变更
- [ ] **Schema变更**: 如果修改了数据库结构，更新ORM模型
- [ ] **迁移脚本**: 考虑是否需要数据迁移
- [ ] **测试数据**: 确保现有数据不会损坏

### 6. 配置文件
- [ ] **配置更新**: 如果添加了新配置项，更新 `config/api_config.yaml`
- [ ] **环境支持**: 确保所有环境（dev/test/prod）都有相应配置
- [ ] **文档更新**: 在 `docs/CONFIG.md` 中记录新配置

### 7. 日志和调试
- [ ] **清理日志**: 删除调试用的print语句
- [ ] **日志级别**: 确保使用适当的日志级别
- [ ] **敏感信息**: 确保不记录敏感信息（密码、token等）

### 8. 性能考虑
- [ ] **内存泄漏**: 检查是否有潜在的内存泄漏
- [ ] **线程安全**: 如果涉及多线程，确保线程安全
- [ ] **资源释放**: 确保正确释放资源（文件、网络连接等）

### 9. 用户体验
- [ ] **错误提示**: 提供清晰的错误提示（使用InfoBar）
- [ ] **加载状态**: 长时间操作显示进度或加载状态
- [ ] **用户反馈**: 操作成功/失败给予明确反馈
- [ ] **国际化**: 如果涉及UI文本，考虑国际化支持

### 10. 文档更新
- [ ] **README**: 如果添加了新功能，更新README
- [ ] **API文档**: 更新相关API文档
- [ ] **示例代码**: 在 `example/` 目录添加使用示例
- [ ] **变更日志**: 记录重要变更

## 提交前检查

### Git提交
- [ ] **提交信息**: 编写清晰的提交信息
- [ ] **分支管理**: 确保在正确的分支上工作
- [ ] **代码审查**: 自我审查代码变更
- [ ] **忽略文件**: 确保不提交临时文件、日志、模型等

### 构建测试
- [ ] **本地构建**: 运行 `python install_build.py` 测试打包
- [ ] **启动测试**: 测试打包后的应用能否正常启动
- [ ] **功能验证**: 验证打包后的应用功能正常

## 发布前检查

### 版本管理
- [ ] **版本号**: 更新 `nice_ui/ui/__init__.py` 中的 `__version__`
- [ ] **pyproject.toml**: 更新 `pyproject.toml` 中的版本号
- [ ] **变更日志**: 编写版本变更说明

### 打包准备
- [ ] **清理构建**: 删除旧的 `build/` 和 `dist/` 目录
- [ ] **清理日志**: 清空 `logs/` 目录
- [ ] **数据库**: 确保 `orm/linlin.db` 是干净的初始状态
- [ ] **凭证**: 确保不包含真实的API密钥

### 平台测试
- [ ] **macOS测试**: 在macOS上完整测试
- [ ] **Windows测试**: 在Windows上完整测试
- [ ] **架构测试**: 测试 arm64 和 x86_64（如适用）

### 文档完善
- [ ] **用户手册**: 更新用户使用文档
- [ ] **安装指南**: 更新安装说明
- [ ] **FAQ**: 更新常见问题解答
- [ ] **API文档**: 确保API文档是最新的

## 特殊注意事项

### macOS特定
- [ ] **multiprocessing**: 确保使用 `spawn` 模式
- [ ] **freeze_support**: 确保调用 `multiprocessing.freeze_support()`
- [ ] **权限**: 测试应用权限（麦克风、文件访问等）

### Windows特定
- [ ] **路径分隔符**: 使用 `os.path.join` 而不是硬编码路径
- [ ] **编码**: 确保文件编码正确（UTF-8）
- [ ] **图标**: 确保Windows图标（.ico）正确

### 云服务集成
- [ ] **API密钥**: 测试API密钥管理
- [ ] **网络错误**: 测试网络错误处理
- [ ] **超时处理**: 确保有适当的超时设置
- [ ] **重试机制**: 验证重试逻辑正常工作

### 数据安全
- [ ] **加密**: 确保敏感数据加密存储
- [ ] **权限**: 检查文件和目录权限
- [ ] **清理**: 确保临时文件被正确清理

## 持续改进

### 代码重构
- [ ] **技术债务**: 记录需要重构的代码
- [ ] **性能优化**: 标记性能瓶颈
- [ ] **代码复用**: 识别可以提取的公共代码

### 用户反馈
- [ ] **Bug追踪**: 记录已知问题
- [ ] **功能请求**: 收集用户功能请求
- [ ] **使用统计**: 考虑添加使用统计（匿名）

## 检查清单使用建议

1. **每次提交前**: 至少完成"代码修改后的必做事项"部分
2. **每次发布前**: 完成所有"发布前检查"项目
3. **定期审查**: 每周/每月审查"持续改进"部分
4. **团队协作**: 在PR中引用此清单，确保代码质量

## 自动化建议

考虑添加以下自动化工具：
- **pre-commit hooks**: 自动运行代码检查
- **CI/CD**: GitHub Actions自动构建和测试
- **代码覆盖率**: 跟踪测试覆盖率
- **依赖检查**: 自动检查依赖安全性
